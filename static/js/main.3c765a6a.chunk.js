(this.webpackJsonprocket=this.webpackJsonprocket||[]).push([[0],{182:function(e){e.exports=JSON.parse('{"b":"0.1.5","a":"rocket"}')},245:function(e,t,n){},272:function(e,t,n){},279:function(e,t,n){"use strict";n.r(t);var a=n(41),r=n(10),o=n.n(r),i=n(140),c=n.n(i),s=(n(272),n(245),n(222)),u=n(223),l=n(262),d=n(261),f=n(49),h=n(284),p=n(263),v=n(243),m=n(264),j=n(173),O=function(e){var t=Object(r.useRef)(null),n=e.antialias,o=e.engineOptions,i=e.adaptToDeviceRatio,c=e.sceneOptions,s=e.onRender,u=(e.onSceneReady,e.renderChildrenWhenReady),l=e.children,d=Object(m.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","renderChildrenWhenReady","children"]),h=Object(r.useState)({scene:null,sceneReady:!1}),O=Object(v.a)(h,2),b=O[0],g=O[1],x=Object(r.useState)({engine:null,canvas:null}),w=Object(v.a)(x,2),y=w[0],C=w[1];return Object(r.useEffect)((function(){if(t.current){var a=new f.c(t.current,n,o,i);C((function(){return{engine:a,canvas:t.current}}));var r=new f.g(a,c),u=r.isReady();u?e.onSceneReady(r):r.onReadyObservable.addOnce((function(n){e.onSceneReady(n),g((function(){return{canvas:t.current,scene:n,engine:a,sceneReady:!0}}))})),a.runRenderLoop((function(){r.activeCamera?("function"===typeof s&&s(r),r.render()):console.warn("no active camera..")}));var l=function(){r.getEngine().resize()};return window&&window.addEventListener("resize",l),g((function(){return{canvas:t.current,scene:r,engine:a,sceneReady:u}})),function(){r.getEngine().dispose(),window&&window.removeEventListener("resize",l)}}}),[t,i,n,o,s,e,c]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("canvas",Object(p.a)({ref:t},d)),Object(a.jsx)(j.a.Provider,{value:y,children:Object(a.jsx)(j.b.Provider,{value:b,children:(!0!==u||!0===u&&b.sceneReady)&&l})})]})},b=(n(278),n(115)),g=n(289),x=n(287),w=n(182),y=function(e){var t=e.onImport,n=e.onReplay;return Object(a.jsxs)(g.a,{variant:"dark",bg:"dark",expand:"lg",children:[Object(a.jsx)(g.a.Brand,{href:"http://www.mmarini.org",children:"www.mmarini.org"}),Object(a.jsx)(g.a.Toggle,{"aria-controls":"navbar-nav"}),Object(a.jsx)(g.a.Collapse,{id:"navbar-nav",children:Object(a.jsxs)(x.a,{className:"mr-auto",children:[Object(a.jsxs)(x.a.Link,{href:w.a,children:["Rocket ",w.b]}),Object(a.jsx)(x.a.Link,{onClick:function(){t&&t()},children:"Import"}),Object(a.jsx)(x.a.Link,{onClick:function(){n&&n()},children:"Replay"})]})})]})},C=n(285),k=n(286),T=n(282),I=n(260),R=function(e){var t=e.show,n=e.onCancel,r=e.onSelect;return Object(a.jsxs)(C.a,{size:"lg",show:t,onHide:function(){n&&n()},children:[Object(a.jsx)(C.a.Header,{closeButton:!0,children:Object(a.jsx)(C.a.Title,{children:"Import definitions from file ?"})}),Object(a.jsxs)(C.a.Body,{children:[Object(a.jsx)("p",{children:"The definitions will be imported from the selected file."}),Object(a.jsx)(k.a,{children:Object(a.jsx)(k.a.File,{label:"Import file",custom:!0,onChange:function(e){return t=e.target.files[0],void(r&&r(Object(I.a)(t.text())));var t}})})]}),Object(a.jsx)(C.a.Footer,{children:Object(a.jsx)(T.a,{variant:"primary",onClick:function(){n&&n()},children:"Cancel"})})]})},M=n(231),S=n(283),L=n(288),F=n(292),E=n(291),_=n(290);var N=n(259),A=n(156),P=n.n(A),z=.25;function B(e,t,n){return t.subtract(e).scale(n).add(e)}var D=function(){function e(t,n){Object(s.a)(this,e),this._path=void 0,this._episodes=void 0,this._path=t,this._episodes=n}return Object(u.a)(e,[{key:"status",value:function(e){var t=this.interval(e);return t?{position:B(t.from.position,t.to.position,t.alpha),speed:B(t.from.speed,t.to.speed,t.alpha),fuel:(t.to.fuel-t.from.fuel)*t.alpha+t.from.fuel,status:t.from.status}:{position:f.l.Zero(),speed:f.l.Zero(),fuel:0,status:0}}},{key:"interval",value:function(e){var t=this.path,n=this._episodes;if(0!==n.length){var a=t.length,r=n.find((function(t){return e>=t.begin&&e<t.end}))||n[n.length-1];if(!r)return{from:t[a-1],to:t[a-1],alpha:0};var o=e-r.begin,i=Math.floor(o/z),c=Math.min(r.from+i,r.to);return c===r.to?{from:t[c],to:t[c],alpha:0}:{from:t[c],to:t[c+1],alpha:(o-i*z)/z}}}},{key:"sampleInterval",get:function(){return z}},{key:"path",get:function(){return this._path}}]),e}();var G,H,U=w.a,Z="/".concat(U,"/texture/moon.jpg"),J="/".concat(U,"/texture/platform.jpg"),W="/".concat(U,"/texture/skybox"),q="/".concat(U,"/objs/"),V="/".concat(U,"/sample.csv"),K=480/360,X=new f.l(-20,1.7,40),Y=["Flying","Landed","Landed Out Of Platform","Crashed On Platform","Crashed Out Of Platform","Crashed On Platform","Crashed Out Of Platform","Out Of Range","Out Of Fuel"],Q=["white","#00ff00","#d80000","#d80000","#d80000","#d80000","#d80000","#d80000","#d80000","#d80000"],$=0;function ee(e){var t,n,a=function(e){var t=new f.d("camera1",X,e);return t.radius=45,t.heightOffset=1.7,t.cameraAcceleration=.01,t.maxCameraSpeed=200/3.6,t}(e),r=function(e){var t=new f.k("camera2",X,e);return t.attachControl(!0),t}(e);a.viewport=new f.m(0,0,.5,1),r.viewport=new f.m(.5,0,.5,1),null===(t=e.activeCameras)||void 0===t||t.push(a),null===(n=e.activeCameras)||void 0===n||n.push(r),G=function(e){var t=b.AdvancedDynamicTexture.CreateFullscreenUI("GUI",void 0,e),n=new b.TextBlock("HUD");n.color="white",n.width="250px",n.height="100px",n.fontFamily="monospace",n.fontSize=20,n.horizontalAlignment=b.Control.HORIZONTAL_ALIGNMENT_LEFT,n.verticalAlignment=b.Control.VERTICAL_ALIGNMENT_TOP,n.textHorizontalAlignment=b.Control.HORIZONTAL_ALIGNMENT_LEFT,n.paddingLeftInPixels=10,t.addControl(n);var a=b.AdvancedDynamicTexture.CreateFullscreenUI("GUI",void 0,e),r=new b.TextBlock("HUD1");return r.width="400px",r.height="50px",r.fontWeight="bold",r.fontSize="28",r.horizontalAlignment=b.Control.HORIZONTAL_ALIGNMENT_CENTER,r.verticalAlignment=b.Control.VERTICAL_ALIGNMENT_BOTTOM,a.addControl(r),[n,r]}(e),function(e){var t=new f.e("light",new f.l(1,1,0),e);t.intensity=1}(e),function(e){var t=new f.i("groundMat",e);t.diffuseTexture=new f.j(Z,e);var n=f.f.CreateGround("ground",{width:1e3,height:1e3,subdivisions:2},e);n.material=t,n.position.y=-.01}(e),function(e){var t=new f.i("platMat",e);t.diffuseTexture=new f.j(J,e);var n=f.f.CreateGround("platform",{width:20*K,height:20*K,subdivisions:2},e);n.material=t,n.receiveShadows=!0}(e),function(e){var t=f.f.CreateBox("skyBox",{size:1200},e),n=new f.i("skyBox",e);n.backFaceCulling=!1,n.reflectionTexture=new f.b(W,e),n.reflectionTexture.coordinatesMode=f.j.SKYBOX_MODE,n.diffuseColor=new f.a(0,0,0),n.specularColor=new f.a(0,0,0),t.material=n}(e),function(e){f.h.ImportMesh("10475_Rocket_Ship_v1_L3",q,"rocket.gltf",e,(function(t,n,a){!function(e,t){var n=e.getCameraByName("camera1"),a=e.getCameraByName("camera2");n&&a&&(t.name="rocket",n.lockedTarget=t,a.lockedTarget=t)}(e,t[0])}))}(e)}function te(e){var t=e.getMeshByName("rocket");if(t&&H){var n=e.getEngine().getDeltaTime()/1e3;$+=n;var a=H.status($);t.position=a.position,function(e,t){if(e){var n=t.position,a=Math.sqrt(n.x*n.x+n.z*n.z),r=180*Math.atan2(n.x,n.z)/Math.PI,o=Math.round(r>0?r:r+360),i=t.speed,c=Math.sqrt(i.x*i.x+i.z*i.z),s=180*Math.atan2(i.x,i.z)/Math.PI,u=Math.round(s>0?s:s+360),l=Object(N.sprintf)("Pos   %05.1f %03d %05.1f\nSpeed %03.1f %03d %+03.1f\nFuel  %05.1f",a,o,n.y,c,u,i.y,t.fuel);e[0].text=l,e[1].text=Y[t.status],e[1].color=Q[t.status]}}(G,a)}}function ne(){return function(e){return e.pipe(Object(_.a)((function(e){return Object(I.a)(e.split(/\r\n|\n/))})),Object(S.a)((function(e){return!!e})),Object(M.a)((function(e){return e.split(",").map(parseFloat)})),Object(M.a)((function(e){return{position:new f.l(e[0],e[2],e[1]),speed:new f.l(e[3],e[5],e[4]),fuel:e[6],status:e[8]}})),Object(L.a)())}}var ae=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={importModalShown:!1},a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(E.a)({url:V,responseType:"text"}).pipe(Object(M.a)((function(e){return e.response})));this.importFile(e)}},{key:"showImportPanel",value:function(){this.setState({importModalShown:!0})}},{key:"onImportCancel",value:function(){this.setState({importModalShown:!1})}},{key:"importFile",value:function(e){var t=this;e.pipe(ne(),Object(F.a)((function(e){return t.onPathReady(e)}),(function(e){return t.onImportError(e)}))).subscribe()}},{key:"onImportFile",value:function(e){this.setState({importModalShown:!1}),this.importFile(e)}},{key:"onPathReady",value:function(e){H=function(e){var t=e.length,n=P()(e).map((function(e,t){return{status:e,i:t}})).filter((function(e){return 0!==e.status.status})).map("i").value(),a=0!==e[t-1].status?P.a.concat([0],n):P.a.concat([0],n,[t-1]),r=a.length,o=P.a.zip(P.a.take(a,r-1),P.a.drop(a,1)).map((function(e,t){var n=e[0]||0,a=e[1]||0;return{from:n,to:a,begin:n*z+5*t,end:a*z+5*(t+1)}}));return new D(e,o)}(e)}},{key:"onImportError",value:function(e){console.error(e)}},{key:"render",value:function(){var e=this,t=this.state.importModalShown;return Object(a.jsxs)(h.a,{fluid:!0,children:[Object(a.jsx)(y,{onImport:function(){return e.showImportPanel()},onReplay:function(){$=0}}),Object(a.jsx)(h.a,{fluid:!0,children:Object(a.jsx)(O,{antialias:!0,width:1400,height:640,onSceneReady:ee,onRender:function(e){te(e)},id:"rocket-canvas"})}),Object(a.jsx)(R,{show:t,onCancel:function(){e.onImportCancel()},onSelect:function(t){return e.onImportFile(t)}})]})}}]),n}(r.Component);var re=function(){return Object(a.jsx)(ae,{})},oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,293)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))};c.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(re,{})}),document.getElementById("root")),oe()}},[[279,1,2]]]);
//# sourceMappingURL=main.3c765a6a.chunk.js.map