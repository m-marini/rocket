(this.webpackJsonprocket=this.webpackJsonprocket||[]).push([[0],{226:function(e,n,t){},247:function(e,n,t){},253:function(e,n,t){"use strict";t.r(n);var r=t(41),a=t(10),o=t.n(a),i=t(131),c=t.n(i),s=(t(247),t(226),t(206)),l=t(207),u=t(214),d=t(212),h=t(49),f=t(256),j=t(240),v=t(224),p=t(241),m=t(161),b=function(e){var n=Object(a.useRef)(null),t=e.antialias,o=e.engineOptions,i=e.adaptToDeviceRatio,c=e.sceneOptions,s=e.onRender,l=(e.onSceneReady,e.renderChildrenWhenReady),u=e.children,d=Object(p.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","renderChildrenWhenReady","children"]),f=Object(a.useState)({scene:null,sceneReady:!1}),b=Object(v.a)(f,2),w=b[0],O=b[1],g=Object(a.useState)({engine:null,canvas:null}),x=Object(v.a)(g,2),y=x[0],k=x[1];return Object(a.useEffect)((function(){if(n.current){var r=new h.c(n.current,t,o,i);k((function(){return{engine:r,canvas:n.current}}));var a=new h.g(r,c),l=a.isReady();l?e.onSceneReady(a):a.onReadyObservable.addOnce((function(t){e.onSceneReady(t),O((function(){return{canvas:n.current,scene:t,engine:r,sceneReady:!0}}))})),r.runRenderLoop((function(){a.activeCamera?("function"===typeof s&&s(a),a.render()):console.warn("no active camera..")}));var u=function(){a.getEngine().resize()};return window&&window.addEventListener("resize",u),O((function(){return{canvas:n.current,scene:a,engine:r,sceneReady:l}})),function(){a.getEngine().dispose(),window&&window.removeEventListener("resize",u)}}}),[n,i,t,o,s,e,c]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("canvas",Object(j.a)({ref:n},d)),Object(r.jsx)(m.a.Provider,{value:y,children:Object(r.jsx)(m.b.Provider,{value:w,children:(!0!==l||!0===l&&w.sceneReady)&&u})})]})},w=(t(252),t(260)),O=t(259),g=function(e){var n=e.onImport,t=e.onReplay;return Object(r.jsxs)(w.a,{variant:"dark",bg:"dark",expand:"lg",children:[Object(r.jsx)(w.a.Brand,{href:"http://www.mmarini.org",children:"www.mmarini.org"}),Object(r.jsx)(w.a.Toggle,{"aria-controls":"navbar-nav"}),Object(r.jsx)(w.a.Collapse,{id:"navbar-nav",children:Object(r.jsxs)(O.a,{className:"mr-auto",children:[Object(r.jsxs)(O.a.Link,{href:"/rocket",children:["Rocket ","0.1.0"]}),Object(r.jsx)(O.a.Link,{onClick:function(){n&&n()},children:"Import"}),Object(r.jsx)(O.a.Link,{onClick:function(){t&&t()},children:"Replay"})]})})]})},x=t(257),y=t(258),k=t(255),C=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(l.a)(t,[{key:"onFileChange",value:function(e){var n=this.props,t=n.onFileRead,r=n.onError;if(t){var a=new FileReader;a.onload=function(e){t(a.result)},a.onerror=function(e){console.error(e),r&&r(e.toString())};try{a.readAsText(e)}catch(o){console.error(o),r&&r(o.toString())}}}},{key:"render",value:function(){var e=this,n=this.props,t=n.show,a=n.onCancel;return Object(r.jsxs)(x.a,{size:"lg",show:t,onHide:function(){a&&a()},children:[Object(r.jsx)(x.a.Header,{closeButton:!0,children:Object(r.jsx)(x.a.Title,{children:"Import definitions from file ?"})}),Object(r.jsxs)(x.a.Body,{children:[Object(r.jsx)("p",{children:"The definitions will be imported from the selected file."}),Object(r.jsx)(y.a,{children:Object(r.jsx)(y.a.File,{label:"Import file",custom:!0,onChange:function(n){return e.onFileChange(n.target.files[0])}})})]}),Object(r.jsx)(x.a.Footer,{children:Object(r.jsx)(k.a,{variant:"primary",onClick:function(){a&&a()},children:"Cancel"})})]})}}]),t}(a.Component),R=480/360,S=new h.l(-20,1.7,40),I=[new h.l(500,150,500),new h.l(250,150,250),new h.l(100,100,100),new h.l(20,50,30),new h.l(7,10,-3),new h.l(-4,0,1)];function F(e){var n,t,r=function(e){var n=new h.d("camera1",S,e);return n.radius=45,n.heightOffset=1.7,n.cameraAcceleration=.01,n.maxCameraSpeed=200/3.6,n}(e),a=function(e){var n=new h.k("camera2",S,e);return n.attachControl(!0),n}(e);r.viewport=new h.m(0,0,.5,1),a.viewport=new h.m(.5,0,.5,1),null===(n=e.activeCameras)||void 0===n||n.push(r),null===(t=e.activeCameras)||void 0===t||t.push(a),new h.e("light",new h.l(1,1,0),e).intensity=1;var o=new h.i("groundMat",e);o.diffuseTexture=new h.j("/rocket/texture/moon.jpg",e);var i=h.f.CreateGround("ground",{width:1e3,height:1e3,subdivisions:2},e);i.material=o,i.position.y=-.01;var c=new h.i("platMat",e);c.diffuseTexture=new h.j("/rocket/texture/platform.jpg",e),h.f.CreateGround("platform",{width:20*R,height:20*R,subdivisions:2},e).material=c;var s=h.f.CreateBox("skyBox",{size:1200},e),l=new h.i("skyBox",e);l.backFaceCulling=!1,l.reflectionTexture=new h.b("/rocket/texture/skybox",e),l.reflectionTexture.coordinatesMode=h.j.SKYBOX_MODE,l.diffuseColor=new h.a(0,0,0),l.specularColor=new h.a(0,0,0),s.material=l,function(e){h.h.ImportMesh("10475_Rocket_Ship_v1_L3","/rocket/objs/","rocket.gltf",e,(function(n,t,r){!function(e,n){var t=e.getCameraByName("camera1"),r=e.getCameraByName("camera2");t&&r&&(n.name="rocket",t.lockedTarget=n,r.lockedTarget=n)}(e,n[0])}))}(e)}var T=function(e){Object(u.a)(t,e);var n=Object(d.a)(t);function t(e){var r;return Object(s.a)(this,t),(r=n.call(this,e)).state={t:0,sampleInterval:30/(I.length-1),path:I,importModalShown:!1},r}return Object(l.a)(t,[{key:"onRender",value:function(e){var n=e.getMeshByName("rocket"),t=this.state,r=t.t,a=t.path,o=t.sampleInterval,i=r+e.getEngine().getDeltaTime()/1e3;if(n&&a){var c=function(e,n,t){if(!t)return h.l.Zero();var r=t.length;if(e>=(r-1)*n)return I[r-1];var a=e/n,o=Math.floor(a),i=a-o,c=I[o];return I[o+1].subtract(c).scale(i).add(c)}(i,o,a);n.position=c}this.setState({t:i})}},{key:"onReplay",value:function(){this.setState({t:0})}},{key:"showImportPanel",value:function(){this.setState({importModalShown:!0})}},{key:"onImportCancel",value:function(){this.setState({importModalShown:!1})}},{key:"onImportFile",value:function(e){console.log(e),this.setState({importModalShown:!1,t:0})}},{key:"onImportError",value:function(e){console.error(e),this.setState({importModalShown:!1})}},{key:"render",value:function(){var e=this,n=this.state.importModalShown;return Object(r.jsxs)(f.a,{fluid:!0,children:[Object(r.jsx)(g,{onImport:function(){return e.showImportPanel()},onReplay:function(){return e.onReplay()}}),Object(r.jsx)(f.a,{fluid:!0,children:Object(r.jsx)(b,{antialias:!0,width:1400,height:640,onSceneReady:F,onRender:function(n){return e.onRender(n)},id:"rocket-canvas"})}),Object(r.jsx)(C,{show:n,onCancel:function(){e.onImportCancel()},onFileRead:function(n){return e.onImportFile(n)},onError:function(n){return e.onImportError(n)}})]})}}]),t}(a.Component);var M=function(){return Object(r.jsx)(T,{})},B=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,261)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,o=n.getLCP,i=n.getTTFB;t(e),r(e),a(e),o(e),i(e)}))};c.a.render(Object(r.jsx)(o.a.StrictMode,{children:Object(r.jsx)(M,{})}),document.getElementById("root")),B()}},[[253,1,2]]]);
//# sourceMappingURL=main.92a7d4ce.chunk.js.map