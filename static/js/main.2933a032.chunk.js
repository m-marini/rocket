(this.webpackJsonprocket=this.webpackJsonprocket||[]).push([[0],{180:function(e){e.exports=JSON.parse('{"b":"0.1.4","a":"rocket"}')},244:function(e,t,n){},271:function(e,t,n){},277:function(e,t,n){"use strict";n.r(t);var r=n(41),a=n(10),i=n.n(a),o=n(139),c=n.n(o),s=(n(271),n(244),n(261)),u=n(260),l=n(240),f=n(241),d=n(49),h=n(282),p=n(262),v=n(242),j=n(263),m=n(171),b=function(e){var t=Object(a.useRef)(null),n=e.antialias,i=e.engineOptions,o=e.adaptToDeviceRatio,c=e.sceneOptions,s=e.onRender,u=(e.onSceneReady,e.renderChildrenWhenReady),l=e.children,f=Object(j.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","renderChildrenWhenReady","children"]),h=Object(a.useState)({scene:null,sceneReady:!1}),b=Object(v.a)(h,2),O=b[0],x=b[1],w=Object(a.useState)({engine:null,canvas:null}),g=Object(v.a)(w,2),y=g[0],k=g[1];return Object(a.useEffect)((function(){if(t.current){var r=new d.c(t.current,n,i,o);k((function(){return{engine:r,canvas:t.current}}));var a=new d.g(r,c),u=a.isReady();u?e.onSceneReady(a):a.onReadyObservable.addOnce((function(n){e.onSceneReady(n),x((function(){return{canvas:t.current,scene:n,engine:r,sceneReady:!0}}))})),r.runRenderLoop((function(){a.activeCamera?("function"===typeof s&&s(a),a.render()):console.warn("no active camera..")}));var l=function(){a.getEngine().resize()};return window&&window.addEventListener("resize",l),x((function(){return{canvas:t.current,scene:a,engine:r,sceneReady:u}})),function(){a.getEngine().dispose(),window&&window.removeEventListener("resize",l)}}}),[t,o,n,i,s,e,c]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("canvas",Object(p.a)({ref:t},f)),Object(r.jsx)(m.a.Provider,{value:y,children:Object(r.jsx)(m.b.Provider,{value:O,children:(!0!==u||!0===u&&O.sceneReady)&&l})})]})},O=(n(276),n(172)),x=n(287),w=n(285),g=n(180),y=function(e){var t=e.onImport,n=e.onReplay;return Object(r.jsxs)(x.a,{variant:"dark",bg:"dark",expand:"lg",children:[Object(r.jsx)(x.a.Brand,{href:"http://www.mmarini.org",children:"www.mmarini.org"}),Object(r.jsx)(x.a.Toggle,{"aria-controls":"navbar-nav"}),Object(r.jsx)(x.a.Collapse,{id:"navbar-nav",children:Object(r.jsxs)(w.a,{className:"mr-auto",children:[Object(r.jsxs)(w.a.Link,{href:g.a,children:["Rocket ",g.b]}),Object(r.jsx)(w.a.Link,{onClick:function(){t&&t()},children:"Import"}),Object(r.jsx)(w.a.Link,{onClick:function(){n&&n()},children:"Replay"})]})})]})},k=n(283),C=n(284),I=n(280),R=n(259),S=function(e){var t=e.show,n=e.onCancel,a=e.onSelect;return Object(r.jsxs)(k.a,{size:"lg",show:t,onHide:function(){n&&n()},children:[Object(r.jsx)(k.a.Header,{closeButton:!0,children:Object(r.jsx)(k.a.Title,{children:"Import definitions from file ?"})}),Object(r.jsxs)(k.a.Body,{children:[Object(r.jsx)("p",{children:"The definitions will be imported from the selected file."}),Object(r.jsx)(C.a,{children:Object(r.jsx)(C.a.File,{label:"Import file",custom:!0,onChange:function(e){return t=e.target.files[0],void(a&&a(Object(R.a)(t.text())));var t}})})]}),Object(r.jsx)(k.a.Footer,{children:Object(r.jsx)(I.a,{variant:"primary",onClick:function(){n&&n()},children:"Cancel"})})]})},T=n(228),M=n(281),_=n(286),F=n(290),L=n(289),E=n(288);var z,B=n(258),N=g.a,P="/".concat(N,"/texture/moon.jpg"),A="/".concat(N,"/texture/platform.jpg"),D="/".concat(N,"/texture/skybox"),G="/".concat(N,"/objs/"),H="/".concat(N,"/sample.csv"),Z=480/360,J=new d.l(-20,1.7,40);function U(e,t,n){return t.subtract(e).scale(n).add(e)}var q=function(){function e(){Object(l.a)(this,e),this._t=void 0,this._sampleInterval=void 0,this._path=void 0,this._t=0,this._sampleInterval=.25}return Object(f.a)(e,[{key:"position",value:function(){var e=this.interpolate();return e?U(e.from.position,e.to.position,e.alpha):d.l.Zero()}},{key:"speed",value:function(){var e=this.interpolate();return e?U(e.from.speed,e.to.speed,e.alpha):d.l.Zero()}},{key:"status",value:function(){var e=this.interpolate();return e?e.from.status:0}},{key:"fuel",value:function(){var e=this.interpolate();return e?(e.to.fuel-e.from.fuel)*e.alpha+e.from.fuel:0}},{key:"interpolate",value:function(){var e=this.path,t=this.t,n=this.sampleInterval;if(e){var r=e.length;if(t>=(r-1)*n)return{from:e[r-1],to:e[r-1],alpha:0};var a=t/n,i=Math.floor(a),o=a-i;return{from:e[i],to:e[i+1],alpha:o}}}},{key:"last",value:function(e){return this.t=this.t+e,this}},{key:"reset",value:function(){this._t=0}},{key:"t",get:function(){return this._t},set:function(e){this._t=e}},{key:"sampleInterval",get:function(){return this._sampleInterval},set:function(e){this._sampleInterval=e,this._t=0}},{key:"path",get:function(){return this._path},set:function(e){this._path=e,this._t=0}}]),e}();var W=function(e,t){var n=new q;return n.path=t,n.sampleInterval=e,n}(.25);function K(e){var t,n,r=function(e){var t=new d.d("camera1",J,e);return t.radius=45,t.heightOffset=1.7,t.cameraAcceleration=.01,t.maxCameraSpeed=200/3.6,t}(e),a=function(e){var t=new d.k("camera2",J,e);return t.attachControl(!0),t}(e);r.viewport=new d.m(0,0,.5,1),a.viewport=new d.m(.5,0,.5,1),null===(t=e.activeCameras)||void 0===t||t.push(r),null===(n=e.activeCameras)||void 0===n||n.push(a),z=function(e){var t=O.AdvancedDynamicTexture.CreateFullscreenUI("GUI",void 0,e),n=new O.TextBlock("HUD");return n.color="white",n.width="250px",n.height="100px",n.fontFamily="monospace",n.fontSize=20,n.horizontalAlignment=O.Control.HORIZONTAL_ALIGNMENT_LEFT,n.verticalAlignment=O.Control.VERTICAL_ALIGNMENT_TOP,n.textHorizontalAlignment=O.Control.HORIZONTAL_ALIGNMENT_LEFT,n.paddingLeftInPixels=10,t.addControl(n),n}(e),function(e){var t=new d.e("light",new d.l(1,1,0),e);t.intensity=1}(e),function(e){var t=new d.i("groundMat",e);t.diffuseTexture=new d.j(P,e);var n=d.f.CreateGround("ground",{width:1e3,height:1e3,subdivisions:2},e);n.material=t,n.position.y=-.01}(e),function(e){var t=new d.i("platMat",e);t.diffuseTexture=new d.j(A,e);var n=d.f.CreateGround("platform",{width:20*Z,height:20*Z,subdivisions:2},e);n.material=t,n.receiveShadows=!0}(e),function(e){var t=d.f.CreateBox("skyBox",{size:1200},e),n=new d.i("skyBox",e);n.backFaceCulling=!1,n.reflectionTexture=new d.b(D,e),n.reflectionTexture.coordinatesMode=d.j.SKYBOX_MODE,n.diffuseColor=new d.a(0,0,0),n.specularColor=new d.a(0,0,0),t.material=n}(e),function(e){d.h.ImportMesh("10475_Rocket_Ship_v1_L3",G,"rocket.gltf",e,(function(t,n,r){!function(e,t){var n=e.getCameraByName("camera1"),r=e.getCameraByName("camera2");n&&r&&(t.name="rocket",n.lockedTarget=t,r.lockedTarget=t)}(e,t[0])}))}(e)}function V(e){var t=e.getEngine().getDeltaTime()/1e3;W.last(t);var n=e.getMeshByName("rocket");n&&(n.position=W.position()),function(e,t){if(e){var n=t.position(),r=Math.sqrt(n.x*n.x+n.z*n.z),a=180*Math.atan2(n.x,n.z)/Math.PI,i=Math.round(a>0?a:a+360),o=t.speed(),c=Math.sqrt(o.x*o.x+o.z*o.z),s=180*Math.atan2(o.x,o.z)/Math.PI,u=Math.round(s>0?s:s+360),l=Object(B.sprintf)("Pos   %05.1f %03d %05.1f\nSpeed %03.1f %03d %+03.1f\nFuel  %05.1f",r,i,n.y,c,u,o.y,t.fuel());e.text=l}}(z,W)}function X(){return function(e){return e.pipe(Object(E.a)((function(e){return Object(R.a)(e.split(/\r\n|\n/))})),Object(M.a)((function(e){return!!e})),Object(T.a)((function(e){return e.split(",").map(parseFloat)})),Object(T.a)((function(e){return{position:new d.l(e[0],e[2],e[1]),speed:new d.l(e[3],e[5],e[4]),fuel:e[6],status:e[8]}})),Object(_.a)())}}var Y=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(l.a)(this,n),(r=t.call(this,e)).state={importModalShown:!1},r}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=Object(L.a)({url:H,responseType:"text"}).pipe(Object(T.a)((function(e){return e.response})));this.importFile(e)}},{key:"showImportPanel",value:function(){this.setState({importModalShown:!0})}},{key:"onImportCancel",value:function(){this.setState({importModalShown:!1})}},{key:"importFile",value:function(e){var t=this;e.pipe(X(),Object(F.a)((function(e){return t.onPathReady(e)}),(function(e){return t.onImportError(e)}))).subscribe()}},{key:"onImportFile",value:function(e){this.setState({importModalShown:!1}),this.importFile(e)}},{key:"onPathReady",value:function(e){W.path=e}},{key:"onImportError",value:function(e){console.error(e)}},{key:"render",value:function(){var e=this,t=this.state.importModalShown;return Object(r.jsxs)(h.a,{fluid:!0,children:[Object(r.jsx)(y,{onImport:function(){return e.showImportPanel()},onReplay:function(){return W.reset()}}),Object(r.jsx)(h.a,{fluid:!0,children:Object(r.jsx)(b,{antialias:!0,width:1400,height:640,onSceneReady:K,onRender:function(e){V(e)},id:"rocket-canvas"})}),Object(r.jsx)(S,{show:t,onCancel:function(){e.onImportCancel()},onSelect:function(t){return e.onImportFile(t)}})]})}}]),n}(a.Component);var Q=function(){return Object(r.jsx)(Y,{})},$=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,291)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};c.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(Q,{})}),document.getElementById("root")),$()}},[[277,1,2]]]);
//# sourceMappingURL=main.2933a032.chunk.js.map