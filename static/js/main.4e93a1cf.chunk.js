(this.webpackJsonprocket=this.webpackJsonprocket||[]).push([[0],{226:function(e,n,t){},247:function(e,n,t){},253:function(e,n,t){"use strict";t.r(n);var r=t(41),a=t(10),i=t.n(a),o=t(131),c=t.n(o),s=(t(247),t(226),t(214)),l=t(212),u=t(169),d=t(170),h=t(49),f=t(256),v=t(240),j=t(224),p=t(241),m=t(161),b=function(e){var n=Object(a.useRef)(null),t=e.antialias,i=e.engineOptions,o=e.adaptToDeviceRatio,c=e.sceneOptions,s=e.onRender,l=(e.onSceneReady,e.renderChildrenWhenReady),u=e.children,d=Object(p.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","renderChildrenWhenReady","children"]),f=Object(a.useState)({scene:null,sceneReady:!1}),b=Object(j.a)(f,2),w=b[0],g=b[1],O=Object(a.useState)({engine:null,canvas:null}),k=Object(j.a)(O,2),x=k[0],y=k[1];return Object(a.useEffect)((function(){if(n.current){var r=new h.c(n.current,t,i,o);y((function(){return{engine:r,canvas:n.current}}));var a=new h.g(r,c),l=a.isReady();l?e.onSceneReady(a):a.onReadyObservable.addOnce((function(t){e.onSceneReady(t),g((function(){return{canvas:n.current,scene:t,engine:r,sceneReady:!0}}))})),r.runRenderLoop((function(){a.activeCamera?("function"===typeof s&&s(a),a.render()):console.warn("no active camera..")}));var u=function(){a.getEngine().resize()};return window&&window.addEventListener("resize",u),g((function(){return{canvas:n.current,scene:a,engine:r,sceneReady:l}})),function(){a.getEngine().dispose(),window&&window.removeEventListener("resize",u)}}}),[n,o,t,i,s,e,c]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("canvas",Object(v.a)({ref:n},d)),Object(r.jsx)(m.a.Provider,{value:x,children:Object(r.jsx)(m.b.Provider,{value:w,children:(!0!==l||!0===l&&w.sceneReady)&&u})})]})},w=(t(252),t(260)),g=t(259),O=function(e){var n=e.onImport,t=e.onReplay;return Object(r.jsxs)(w.a,{variant:"dark",bg:"dark",expand:"lg",children:[Object(r.jsx)(w.a.Brand,{href:"http://www.mmarini.org",children:"www.mmarini.org"}),Object(r.jsx)(w.a.Toggle,{"aria-controls":"navbar-nav"}),Object(r.jsx)(w.a.Collapse,{id:"navbar-nav",children:Object(r.jsxs)(g.a,{className:"mr-auto",children:[Object(r.jsxs)(g.a.Link,{href:"/rocket",children:["Rocket ","0.1.1"]}),Object(r.jsx)(g.a.Link,{onClick:function(){n&&n()},children:"Import"}),Object(r.jsx)(g.a.Link,{onClick:function(){t&&t()},children:"Replay"})]})})]})},k=t(257),x=t(258),y=t(255),C=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(){return Object(u.a)(this,t),n.apply(this,arguments)}return Object(d.a)(t,[{key:"onFileChange",value:function(e){var n=this.props,t=n.onFileRead,r=n.onError;if(t){var a=new FileReader;a.onload=function(e){t(a.result)},a.onerror=function(e){console.error(e),r&&r(e.toString())};try{a.readAsText(e)}catch(i){console.error(i),r&&r(i.toString())}}}},{key:"render",value:function(){var e=this,n=this.props,t=n.show,a=n.onCancel;return Object(r.jsxs)(k.a,{size:"lg",show:t,onHide:function(){a&&a()},children:[Object(r.jsx)(k.a.Header,{closeButton:!0,children:Object(r.jsx)(k.a.Title,{children:"Import definitions from file ?"})}),Object(r.jsxs)(k.a.Body,{children:[Object(r.jsx)("p",{children:"The definitions will be imported from the selected file."}),Object(r.jsx)(x.a,{children:Object(r.jsx)(x.a.File,{label:"Import file",custom:!0,onChange:function(n){return e.onFileChange(n.target.files[0])}})})]}),Object(r.jsx)(k.a.Footer,{children:Object(r.jsx)(y.a,{variant:"primary",onClick:function(){a&&a()},children:"Cancel"})})]})}}]),t}(a.Component),R=480/360,S=new h.l(-20,1.7,40),I=[new h.l(500,150,500),new h.l(250,150,250),new h.l(100,100,100),new h.l(20,50,30),new h.l(7,10,-3),new h.l(-4,0,1)],_=function(){function e(){Object(u.a)(this,e),this._t=void 0,this._sampleInterval=void 0,this._path=void 0,this._t=0,this._sampleInterval=0}return Object(d.a)(e,[{key:"position",value:function(){var e=this.path,n=this.t,t=this.sampleInterval;if(!e)return h.l.Zero();var r=e.length;if(n>=(r-1)*t)return e[r-1];var a=n/t,i=Math.floor(a),o=a-i,c=e[i];return e[i+1].subtract(c).scale(o).add(c)}},{key:"last",value:function(e){return this.t=this.t+e,this}},{key:"reset",value:function(){this._t=0}},{key:"t",get:function(){return this._t},set:function(e){this._t=e}},{key:"sampleInterval",get:function(){return this._sampleInterval},set:function(e){this._sampleInterval=e,this._t=0}},{key:"path",get:function(){return this._path},set:function(e){this._path=e,this._t=0}}]),e}();var F=function(e,n){var t=new _;return t.path=n,t.sampleInterval=e,t}(30/(I.length-1),I);function T(e){var n,t,r=function(e){var n=new h.d("camera1",S,e);return n.radius=45,n.heightOffset=1.7,n.cameraAcceleration=.01,n.maxCameraSpeed=200/3.6,n}(e),a=function(e){var n=new h.k("camera2",S,e);return n.attachControl(!0),n}(e);r.viewport=new h.m(0,0,.5,1),a.viewport=new h.m(.5,0,.5,1),null===(n=e.activeCameras)||void 0===n||n.push(r),null===(t=e.activeCameras)||void 0===t||t.push(a),function(e){var n=new h.e("light",new h.l(1,1,0),e);n.intensity=1}(e),function(e){var n=new h.i("groundMat",e);n.diffuseTexture=new h.j("/rocket/texture/moon.jpg",e);var t=h.f.CreateGround("ground",{width:1e3,height:1e3,subdivisions:2},e);t.material=n,t.position.y=-.01}(e),function(e){var n=new h.i("platMat",e);n.diffuseTexture=new h.j("/rocket/texture/platform.jpg",e);var t=h.f.CreateGround("platform",{width:20*R,height:20*R,subdivisions:2},e);t.material=n,t.receiveShadows=!0}(e),function(e){var n=h.f.CreateBox("skyBox",{size:1200},e),t=new h.i("skyBox",e);t.backFaceCulling=!1,t.reflectionTexture=new h.b("io/rocket/texture/skybox",e),t.reflectionTexture.coordinatesMode=h.j.SKYBOX_MODE,t.diffuseColor=new h.a(0,0,0),t.specularColor=new h.a(0,0,0),n.material=t}(e),function(e){h.h.ImportMesh("10475_Rocket_Ship_v1_L3","/rocket/objs/","rocket.gltf",e,(function(n,t,r){!function(e,n){var t=e.getCameraByName("camera1"),r=e.getCameraByName("camera2");t&&r&&(n.name="rocket",t.lockedTarget=n,r.lockedTarget=n)}(e,n[0])}))}(e)}var M=function(e){Object(s.a)(t,e);var n=Object(l.a)(t);function t(e){var r;return Object(u.a)(this,t),(r=n.call(this,e)).state={importModalShown:!1},r}return Object(d.a)(t,[{key:"showImportPanel",value:function(){this.setState({importModalShown:!0})}},{key:"onImportCancel",value:function(){this.setState({importModalShown:!1})}},{key:"onImportFile",value:function(e){console.log(e),this.setState({importModalShown:!1})}},{key:"onImportError",value:function(e){console.error(e),this.setState({importModalShown:!1})}},{key:"render",value:function(){var e=this,n=this.state.importModalShown;return Object(r.jsxs)(f.a,{fluid:!0,children:[Object(r.jsx)(O,{onImport:function(){return e.showImportPanel()},onReplay:function(){return F.reset()}}),Object(r.jsx)(f.a,{fluid:!0,children:Object(r.jsx)(b,{antialias:!0,width:1400,height:640,onSceneReady:T,onRender:function(e){!function(e){var n=e.getEngine().getDeltaTime()/1e3;F.last(n);var t=e.getMeshByName("rocket");t&&(t.position=F.position())}(e)},id:"rocket-canvas"})}),Object(r.jsx)(C,{show:n,onCancel:function(){e.onImportCancel()},onFileRead:function(n){return e.onImportFile(n)},onError:function(n){return e.onImportError(n)}})]})}}]),t}(a.Component);var B=function(){return Object(r.jsx)(M,{})},E=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,261)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),r(e),a(e),i(e),o(e)}))};c.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(B,{})}),document.getElementById("root")),E()}},[[253,1,2]]]);
//# sourceMappingURL=main.4e93a1cf.chunk.js.map