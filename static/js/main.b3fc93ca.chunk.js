(this.webpackJsonprocket=this.webpackJsonprocket||[]).push([[0],{179:function(e){e.exports=JSON.parse('{"b":"0.1.3","a":"rocket"}')},242:function(e,n,t){},269:function(e,n,t){},274:function(e,n,t){"use strict";t.r(n);var r=t(41),a=t(10),i=t.n(a),o=t(139),c=t.n(o),s=(t(269),t(242),t(259)),u=t(258),l=t(238),d=t(239),h=t(55),f=t(279),p=t(260),v=t(240),j=t(261),b=t(171),m=function(e){var n=Object(a.useRef)(null),t=e.antialias,i=e.engineOptions,o=e.adaptToDeviceRatio,c=e.sceneOptions,s=e.onRender,u=(e.onSceneReady,e.renderChildrenWhenReady),l=e.children,d=Object(j.a)(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","renderChildrenWhenReady","children"]),f=Object(a.useState)({scene:null,sceneReady:!1}),m=Object(v.a)(f,2),O=m[0],w=m[1],g=Object(a.useState)({engine:null,canvas:null}),x=Object(v.a)(g,2),y=x[0],k=x[1];return Object(a.useEffect)((function(){if(n.current){var r=new h.c(n.current,t,i,o);k((function(){return{engine:r,canvas:n.current}}));var a=new h.g(r,c),u=a.isReady();u?e.onSceneReady(a):a.onReadyObservable.addOnce((function(t){e.onSceneReady(t),w((function(){return{canvas:n.current,scene:t,engine:r,sceneReady:!0}}))})),r.runRenderLoop((function(){a.activeCamera?("function"===typeof s&&s(a),a.render()):console.warn("no active camera..")}));var l=function(){a.getEngine().resize()};return window&&window.addEventListener("resize",l),w((function(){return{canvas:n.current,scene:a,engine:r,sceneReady:u}})),function(){a.getEngine().dispose(),window&&window.removeEventListener("resize",l)}}}),[n,o,t,i,s,e,c]),Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("canvas",Object(p.a)({ref:n},d)),Object(r.jsx)(b.a.Provider,{value:y,children:Object(r.jsx)(b.b.Provider,{value:O,children:(!0!==u||!0===u&&O.sceneReady)&&l})})]})},O=(t(273),t(284)),w=t(282),g=t(179),x=function(e){var n=e.onImport,t=e.onReplay;return Object(r.jsxs)(O.a,{variant:"dark",bg:"dark",expand:"lg",children:[Object(r.jsx)(O.a.Brand,{href:"http://www.mmarini.org",children:"www.mmarini.org"}),Object(r.jsx)(O.a.Toggle,{"aria-controls":"navbar-nav"}),Object(r.jsx)(O.a.Collapse,{id:"navbar-nav",children:Object(r.jsxs)(w.a,{className:"mr-auto",children:[Object(r.jsxs)(w.a.Link,{href:g.a,children:["Rocket ",g.b]}),Object(r.jsx)(w.a.Link,{onClick:function(){n&&n()},children:"Import"}),Object(r.jsx)(w.a.Link,{onClick:function(){t&&t()},children:"Replay"})]})})]})},y=t(280),k=t(281),C=t(277),R=t(257),S=function(e){var n=e.show,t=e.onCancel,a=e.onSelect;return Object(r.jsxs)(y.a,{size:"lg",show:n,onHide:function(){t&&t()},children:[Object(r.jsx)(y.a.Header,{closeButton:!0,children:Object(r.jsx)(y.a.Title,{children:"Import definitions from file ?"})}),Object(r.jsxs)(y.a.Body,{children:[Object(r.jsx)("p",{children:"The definitions will be imported from the selected file."}),Object(r.jsx)(k.a,{children:Object(r.jsx)(k.a.File,{label:"Import file",custom:!0,onChange:function(e){return n=e.target.files[0],void(a&&a(Object(R.a)(n.text())));var n}})})]}),Object(r.jsx)(y.a.Footer,{children:Object(r.jsx)(C.a,{variant:"primary",onClick:function(){t&&t()},children:"Cancel"})})]})},I=t(278),_=t(283),T=t(226),F=t(287),M=t(286),B=t(285);var E=g.a,L="/".concat(E,"/texture/moon.jpg"),P="/".concat(E,"/texture/platform.jpg"),D="/".concat(E,"/texture/skybox"),z="/".concat(E,"/objs/"),N="/".concat(E,"/sample.csv"),J=480/360,G=new h.l(-20,1.7,40),H=function(){function e(){Object(l.a)(this,e),this._t=void 0,this._sampleInterval=void 0,this._path=void 0,this._t=0,this._sampleInterval=.25}return Object(d.a)(e,[{key:"position",value:function(){var e=this.path,n=this.t,t=this.sampleInterval;if(!e)return h.l.Zero();var r=e.length;if(n>=(r-1)*t)return e[r-1];var a=n/t,i=Math.floor(a),o=a-i,c=e[i];return e[i+1].subtract(c).scale(o).add(c)}},{key:"last",value:function(e){return this.t=this.t+e,this}},{key:"reset",value:function(){this._t=0}},{key:"t",get:function(){return this._t},set:function(e){this._t=e}},{key:"sampleInterval",get:function(){return this._sampleInterval},set:function(e){this._sampleInterval=e,this._t=0}},{key:"path",get:function(){return this._path},set:function(e){this._path=e,this._t=0}}]),e}();var W=function(e,n){var t=new H;return t.path=n,t.sampleInterval=e,t}(.25);function A(e){var n,t,r=function(e){var n=new h.d("camera1",G,e);return n.radius=45,n.heightOffset=1.7,n.cameraAcceleration=.01,n.maxCameraSpeed=200/3.6,n}(e),a=function(e){var n=new h.k("camera2",G,e);return n.attachControl(!0),n}(e);r.viewport=new h.m(0,0,.5,1),a.viewport=new h.m(.5,0,.5,1),null===(n=e.activeCameras)||void 0===n||n.push(r),null===(t=e.activeCameras)||void 0===t||t.push(a),function(e){var n=new h.e("light",new h.l(1,1,0),e);n.intensity=1}(e),function(e){var n=new h.i("groundMat",e);n.diffuseTexture=new h.j(L,e);var t=h.f.CreateGround("ground",{width:1e3,height:1e3,subdivisions:2},e);t.material=n,t.position.y=-.01}(e),function(e){var n=new h.i("platMat",e);n.diffuseTexture=new h.j(P,e);var t=h.f.CreateGround("platform",{width:20*J,height:20*J,subdivisions:2},e);t.material=n,t.receiveShadows=!0}(e),function(e){var n=h.f.CreateBox("skyBox",{size:1200},e),t=new h.i("skyBox",e);t.backFaceCulling=!1,t.reflectionTexture=new h.b(D,e),t.reflectionTexture.coordinatesMode=h.j.SKYBOX_MODE,t.diffuseColor=new h.a(0,0,0),t.specularColor=new h.a(0,0,0),n.material=t}(e),function(e){h.h.ImportMesh("10475_Rocket_Ship_v1_L3",z,"rocket.gltf",e,(function(n,t,r){!function(e,n){var t=e.getCameraByName("camera1"),r=e.getCameraByName("camera2");t&&r&&(n.name="rocket",t.lockedTarget=n,r.lockedTarget=n)}(e,n[0])}))}(e)}function K(){return function(e){return e.pipe(Object(B.a)((function(e){return Object(R.a)(e.split(/\r\n|\n/))})),Object(I.a)((function(e){return!!e})),Object(T.a)((function(e){return e.split(",").map(parseFloat)})),(n=0,Object(T.a)((function(e){return new h.l(e[n],e[n+2],e[n+1])}))),Object(_.a)());var n}}var X=function(e){Object(s.a)(t,e);var n=Object(u.a)(t);function t(e){var r;return Object(l.a)(this,t),(r=n.call(this,e)).state={importModalShown:!1},r}return Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=Object(M.a)({url:N,responseType:"text"}).pipe(Object(T.a)((function(e){return e.response})));this.importFile(e)}},{key:"showImportPanel",value:function(){this.setState({importModalShown:!0})}},{key:"onImportCancel",value:function(){this.setState({importModalShown:!1})}},{key:"importFile",value:function(e){var n=this;e.pipe(K(),Object(F.a)((function(e){return n.onPathReady(e)}),(function(e){return n.onImportError(e)}))).subscribe()}},{key:"onImportFile",value:function(e){this.setState({importModalShown:!1}),this.importFile(e)}},{key:"onPathReady",value:function(e){W.path=e}},{key:"onImportError",value:function(e){console.error(e)}},{key:"render",value:function(){var e=this,n=this.state.importModalShown;return Object(r.jsxs)(f.a,{fluid:!0,children:[Object(r.jsx)(x,{onImport:function(){return e.showImportPanel()},onReplay:function(){return W.reset()}}),Object(r.jsx)(f.a,{fluid:!0,children:Object(r.jsx)(m,{antialias:!0,width:1400,height:640,onSceneReady:A,onRender:function(e){!function(e){var n=e.getEngine().getDeltaTime()/1e3;W.last(n);var t=e.getMeshByName("rocket");t&&(t.position=W.position())}(e)},id:"rocket-canvas"})}),Object(r.jsx)(S,{show:n,onCancel:function(){e.onImportCancel()},onSelect:function(n){return e.onImportFile(n)}})]})}}]),t}(a.Component);var Y=function(){return Object(r.jsx)(X,{})},Z=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,288)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),r(e),a(e),i(e),o(e)}))};c.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(Y,{})}),document.getElementById("root")),Z()}},[[274,1,2]]]);
//# sourceMappingURL=main.b3fc93ca.chunk.js.map